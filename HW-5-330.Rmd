---
title: "life expectancy"
author: "Ethan Kemeny Chris Trippe"
date: "10/27/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(MASS)
library(lmtest)
library(car)
library(gridExtra)
```

1.

Marcroeconomists hypothesize that there is a relationship between life expectancy and the economic well-being  of the country. The given data provides a economic group for which each country is a part of (OECD--the organisation for Economic Co-operation and Development, a think tank set towards improving global social and economic well-being, Africa, or another group) and the per person GDP (PPDGP). Building a regression model will allow for inference on which group is associated with higher life expectancy and help understand the effect PPDGP has on life expectancy.

```{r, messege = FALSE, echo = FALSE}

life_data <- read.table(file = "life.txt", header = TRUE, stringsAsFactors = TRUE)

life_data$Group <- relevel(life_data$Group, "other")
```

2.

```{r}
scatter <- ggplot(data = life_data, aes(x = log(life_data$PPGDP), y = life_data$LifeExp, group = interaction(life_data$Group))) + geom_point(aes(color = interaction(life_data$Group))) + xlab("log(PPGDP)") + ylab("Life Expectancy") + labs(color = "Group")+ scale_color_manual(values=c("Purple", "Red", "Blue")) +
  theme_bw()

box <- ggplot(life_data, aes(x = life_data$Group, y = life_data$LifeExp)) + geom_boxplot() +  ylab("Life Expectancy") + xlab("Group") + theme_bw() 

grid.arrange(scatter, box, ncol= 2)
```


When looking at the scatterplot of Life Expectancy and log(PPGDP), group africa and other have about the same slope while group oecd slope is different. This means that depending on whether the group is oecd or not, the effect that log(PPGDP) has on Life Expectancy differs. This implies an interaction.

3.

$$y_i = \beta_0 + \beta_1(log(PPGDP)_i) + \beta_2I(Group_i = africa) +\\ \beta_3I(Group_i = oecd) + \beta_4(log(PPGDP)_i)(Group_i = afica) + \\ \beta_5(log(PPGDP)_i)(Group_i = oecd) + \epsilon_{ip} \text{ where } \epsilon_i \sim \mathcal{N}(\mu,\,\sigma^{2})$$

$\beta_0$: the intercept; for countries in groups other than Africa and OECD with a PPGDP of zero, the life expectancy is $\beta_0$, on average.

$\beta_1$: Holding all else contstant and being in group other, as PPGDP goes up by 1, the life expectancy goes up by $\beta_1$, on average.

$\beta_2$: For equal PPGDP levels, a country in group Africa has a increase of $\beta_2$ life expectancy than a country in group "other", on average not including the interaction. 

$\beta_3$: For equal PPGDP levels, a country in group oecd has a $\beta_3$ higher life expectancy than a country in group "other", on average not including the interaction. 

$\beta_4$: The increase of life expencatncy for an African country in addition to $\beta_1$ as log(PPGDP) goes up by 1.

$\beta_5$: The increase of life expencatncy for an OECD country in addition to $\beta_1$ as log(PPGDP) goes up by 1.

This model assumes linear data, independence, normality of the residuals and equal variance.

Using this model we will know that being in an OECD country, on average we'd expect life expectancy to be $\beta_3$ + $\beta_5$ higher than a country in group other.  


4. 
```{r}
#Transformed slr with interactions
slr_transform <- lm(LifeExp ~ log(PPGDP) + Group + log(PPGDP)*Group, data = life_data)
summary(slr_transform)$coefficients
```

$$y_i = 50.42 + 2.94(log(PPGDP)_i) - 11.9I(Group_i = africa) + 11.29I(Group_i = oecd) - 0.04(log(PPGDP)_i)(Group_i = afica) - 0.95(log(PPGDP)_i)(Group_i = oecd)$$

```{r}
scatter + geom_smooth(method = lm, aes(color = interaction(life_data$Group)), se = FALSE)
```

5. 



6.

```{r}
summary(slr_transform)
```

```{r}
confint(slr_transform)
```

